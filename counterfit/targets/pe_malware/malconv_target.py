from secml_malware.attack.blackbox.c_wrapper_phi import CEnd2EndWrapperPhi
from secml_malware.models import CClassifierEnd2EndMalware, MalConv

from counterfit.core.targets import SecMLMalwareTarget


class MalConvTarget(SecMLMalwareTarget):
	model_name = 'malconv'
	model_endpoint = 'included inside secml-malware'

	def __init__(self):
		super(MalConvTarget, self).__init__()
		model = CClassifierEnd2EndMalware(MalConv())
		model.load_pretrained_model()
		self.model = CEnd2EndWrapperPhi(model)
